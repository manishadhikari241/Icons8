$('.photobanner-slider').owlCarousel({
    loop: true,
    center: true,
    items: 1,
    nav: false,
    navText: ["<i class='fas fa-angle-left fa-2x'></i>", "<i class='fas fa-angle-right fa-2x'></i>"],
    margin: 0,
    autoplay: true,
    dots: true,
    autoplayTimeout: 8500,
    smartSpeed: 500,
    responsive: {
        0: {
            items: 1
        }
    }
});

$('.owl-carousel').owlCarousel({
    loop: true,
    // margin:10,
    nav: true,
    items: 4,
    pagination: false,
    autoplay: false,
    smartSpeed: 1000,
    navText: ["<i class='fa fa-chevron-left fa-1x'></i>", "<i class='fa fa-chevron-right fa-1x'></i>"],
    dots: true,
    responsive: {
        0: {
            items: 1
        },
        400: {
            items: 2
        },
        600: {
            items: 3
        },
        1000: {
            items: 4
        }
    }
});


//click functionality
var click = function () {
    $('.app-popup-toggle').on('click', function () {
        $(this).parent().toggleClass('-is-open');
    });

    $('.gamburg-btn').on('click', function () {
        $('.main-nav').toggleClass('nav-open');
    });

    $('.app-menu-toggle').on('click', function (e) {
        $(this).toggleClass('open');
        if ($(this).hasClass('open')) {
            $('.app-left-sidebar').addClass('is-active');
        } else {
            $('.app-left-sidebar').removeClass('is-active');
        }
        e.stopPropagation();
    });

    $('.app-page').on('click', function () {
        $('.app-menu-toggle').removeClass('open');
        $('.app-left-sidebar').removeClass('is-active');
    });


    $('.search-mobile-trigger').on('click', function () {
        $('.app-search-top').addClass('has-mobile-show');
        $(this).hide();
    });


    $('.app-expand > .title').on('click', function () {
        $(this).parent().toggleClass('is-open');
        $(this).next().toggle();
    });

    $('.nav-item.has-dropdown').on('click', function () {
        $(this).toggleClass('dropdown-open');
    });

    $('.category-btn').on('click', function () {
        $(this).next().toggle();
    });

    $('#create-topic,.toggler').on('click', function () {
        $('#reply-control').toggleClass('hide-preview');
    });


    $('.switch-mode strong').on('click', function () {
        $('.toggleform').toggle();

    });

    $('#search-button').on('click', function (e) {
        e.preventDefault();
        $(this).parents('.header-dropdown-toggle').toggleClass('active');
        $('.search-menu').toggle();
    });

    $('#toggle-hamburger-menu').on('click', function (e) {
        e.preventDefault();
        $(this).parents('.header-dropdown-toggle').toggleClass('active');
        $('.hamburger-panel').toggle();
    });
    $('#user-setting-button').on('click', function (e) {
        e.preventDefault();
        $(this).parents('.header-dropdown-toggle').toggleClass('active');
        $('.user-setting-panel').toggle();
    });

    $('.filter-category-field').on('click', function () {
        $(this).parents('.filter-category').toggleClass('is-open');
    })

    $('.tracks-item-tags-btn').on('click', function () {
        $(this).parents('.app-popup').toggleClass('is-open');
    })

    $('.filter-details button.summary').on('click', function () {
        $(this).parent().toggleClass('is-expand')
    })

    $('.sort-switch button').on('click', function () {
        $('.sort-switch button').removeClass('is-active');
        $(this).addClass('is-active');
    })
    $('.auth-app-popup--toggle').on('click', function (e) {
        e.preventDefault();
        $(this).parents('.auth-app-popup').toggleClass('is-open');
    })

    $('.photo-details .summary').on('click', function (e) {
        e.preventDefault();
        $(this).parents('.details').toggleClass('is-expand');
    })


};


(function () {
    'use strict';


    //preloader
    $(window).on('load', function () {
        $(".loader").fadeOut();
        $("#preloder").delay(400).fadeOut("slow");
    });


    //icons slider
    var iconSlider = function () {
        var $slide = $('.app-tabs-item'),
            $slideGroup = $('.app-tabs-header'),
            $button = $('.is-next');


        var slideCount = $slide.length;

        var slideWidth = $slide.width() * 10;

        // var slideUlWidth =  slideCount * slideWidth;

        var slidewidth = 0;
        $('.app-tabs-wrap button.is-prev').on('click', function () {

            slidewidth = slidewidth + slideWidth;
            $slide.stop().animate({
                right: slidewidth
            }, 200, function () {
                console.log(slidewidth);
                $slide.css("left", "");
            });
            // console.log($slideGroup.innerWidth());
        });


        $('.app-tabs-wrap button.is-next').on('click', function () {
            // slidewidth=0;
            if (slidewidth === 0) {
                console.log('error')
            } else {
                console.log('ok');
                slidewidth = slidewidth - slideWidth;
                $slide.stop().animate({
                    right: slidewidth
                }, 200, function () {

                    console.log(slidewidth);
                    // $slide.css("right","");
                });
            }

        });
    };

    //initialization
    click();
    iconSlider();


})();


$('#reply-control .category-input .category-collection li').on('click', function () {
    var categoryname = $(this).find('.category-name').text();
    $('#reply-categoryBtn span').text(categoryname);
    $(this).parents('.select-kit-body').hide();
});

$('.editinput').on('click', function (e) {
    e.preventDefault();
    $(this).next().toggle();
});

$('.icon').on('click', '.to-collection', function () {
    var parent = $(this).parents('.icon');
    parent.toggleClass('is-selected');
    var imgurl = parent.find('img').attr('src');
    var dataid = parent.find('img').data('id');
    if (parent.hasClass('is-selected')) {
        parent.find('.icon-title').prepend(`<span class="heart" style="color:#28b351"><i class="icofont-heart"></i></span>`);
        parent.find('.to-collection').remove();
        parent.append(`<div class="to-collection"><span class="basket"  style="color:red"><i class="icofont-trash"></i></span>
                            <span class="red-title"  style="color:red">Remove</span>
                        </div>`)
        $('.wrap-icon').append(`<div class="app-icon icon" style="width: 32px; height: 32px;">
                               <img alt="Mongrol icon" src="${imgurl}" data-id="${dataid}" >
                             </div>`);
        totalitem();
        collectionWorkspace(imgurl, dataid);

    } else {
        parent.find('.icon-title span:first-child').remove();
        parent.find('.to-collection').remove();
        parent.append(`<div class="to-collection">
                        <span class="plus">+&nbsp;</span>
                        <span>Collection</span>
                        </div>`);
        var c = $('.wrap-icon').find('.app-icon');
        c.each(function () {
            if ($(this).children('img').attr('src') === imgurl) {
                $(this).remove();
                totalitem();
            }
        });

        var cw = $('.collection-sidebar .icons ').find('.icon');
        cw.each(function () {
            if ($(this).find('img').attr('src') === imgurl) {
                $(this).remove();
                totalitem();
            }
        });
    }


})

let remove = (r) => {
    var icons_grid = $('.icons-grid');
    var icon_img = icons_grid.find('img');
    var icon = icons_grid.find('.icon');
    var cw = $('.wrap-icon').find('.app-icon');
    icon.each(function () {

        if ($(this).find('.app-icon img').attr('data-id') == r) {
            $(this).toggleClass('is-selected');
            $(this).find('.icon-title span:first-child').remove();
            $(this).find('.to-collection').remove();
            $(this).append(`<div class="to-collection">
                                <span class="plus">+&nbsp;</span>
                                <span>Collection</span>
                                </div>`);

            totalitem();
        }
    });
    cw.each(function () {
        if ($(this).find('img').attr('data-id') == r) {
            $(this).remove();
            totalitem();
        }
    });

};

// var collection_remove=function(d_id){
$('.collection-sidebar ').on('click', '.remove', function () {
    var c_parent = $(this).prev().find('img').data('id');
    remove(c_parent);
    $(this).parent().remove();
})
// }


var totalitem = function () {
    var n = $('.wrap-icon .app-icon').length;
    $('.recent-collection .info.is-no-inline span').text(n);
    // console.log(n);
}
var collectionWorkspace = function (a, b) {
    $('.collection-sidebar .icons').append(`<div class="icon">
                                    <div class="app-icon ">
                                        <img alt="Mongrol icon" style="height: 50px; width: 50px;"
                                             src="${a}" data-id="${b}">
                                    </div>

                                    <div class="remove">
                                        <i class="icofont-trash"></i>
                                    </div>
                                </div>`)
};


$('.close-collection').on('click', function () {
    $(this).parent().removeClass('is-active');
});

$('.collections').on('click', '.view-all', function () {

    $('.app-right-sidebar').toggleClass('is-active');

});
